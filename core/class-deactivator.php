<?php
/**
 * کلاس غیرفعال‌ساز (Deactivator)
 * وظیفه: پاکسازی موقت و اطمینان از خروج ایمن افزونه از مدار سایت.
 */

// جلوگیری از دسترسی مستقیم
if (!defined('ABSPATH')) {
    exit;
}

class ISP_Deactivator {

    /**
     * متد اصلی که هنگام غیرفعال‌سازی افزونه اجرا می‌شود
     */
    public static function deactivate() {
        /**
         * ما تنظیمات اصلی (isp_settings) را در اینجا پاک نمی‌کنیم.
         * چون ممکن است کاربر بخواهد دوباره افزونه را فعال کند و نخواهد تنظیماتش از دست برود.
         * پاکسازی کامل فقط در فایل uninstall.php (زمان حذف قطعی) انجام خواهد شد.
         */

        // ۱. بروزرسانی مجدد پیوندهای یکتا برای اطمینان از سلامت آدرس‌های سایت
        flush_rewrite_rules();

        // ۲. متوقف کردن تمام زمان‌بندی‌های خودکار افزونه (Cron Jobs) اگر وجود داشته باشند
        wp_clear_scheduled_hook('isp_daily_cleanup_event');
    }
}